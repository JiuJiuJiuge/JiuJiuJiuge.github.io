<!doctype html><html dir=ltr lang=en data-theme class="html theme--light"><head><title>Change in soil phosphorous distribution and bioavailability within water-stable aggregates under long-term Camellia Oleifera cultivation |
Yukun Lu</title><meta charset=utf-8><meta name=generator content="Hugo 0.119.0"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=author content="Yukun Lu"><meta name=description content="Change in soil phosphorous distribution and bioavailability within water-stable aggregates under long-term *Camellia Oleifera* cultivation"><link rel=stylesheet href=/scss/main.min.1147aa5bacb4bce677a0e264073829caedb82fd18ea07a5f1d80521f539d1c45.css integrity="sha256-EUeqW6y0vOZ3oOJkBzgpyu24L9GOoHpfHYBSH1OdHEU=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/css/markupHighlight.min.73ccfdf28df555e11009c13c20ced067af3cb021504cba43644c705930428b00.css integrity="sha256-c8z98o31VeEQCcE8IM7QZ688sCFQTLpDZExwWTBCiwA=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/fontawesome.min.7d272de35b410fb165377550cdf9c4d3a80fbbcc961e111914e4d5c0eaf5729f.css integrity="sha256-fSct41tBD7FlN3VQzfnE06gPu8yWHhEZFOTVwOr1cp8=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/solid.min.55d8333481b07a08e07cf6f37319753a2b47e99f4c395394c5747b48b495aa9b.css integrity="sha256-VdgzNIGwegjgfPbzcxl1OitH6Z9MOVOUxXR7SLSVqps=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/regular.min.a7448d02590b43449364b6b5922ed9af5410abb4de4238412a830316dedb850b.css integrity="sha256-p0SNAlkLQ0STZLa1ki7Zr1QQq7TeQjhBKoMDFt7bhQs=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/brands.min.9ed75a5d670c953fe4df935937674b4646f92674367e9e66eb995bb04e821647.css integrity="sha256-ntdaXWcMlT/k35NZN2dLRkb5JnQ2fp5m65lbsE6CFkc=" crossorigin=anonymous type=text/css><link rel="shortcut icon" href=/favicons/favicon.ico type=image/x-icon><link rel=apple-touch-icon sizes=180x180 href=/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicons/favicon-16x16.png><link rel=canonical href=https://JiuJiuJiuge.github.io/code/code2/><script type=text/javascript src=/js/anatole-header.min.f9132794301a01ff16550ed66763482bd848f62243d278f5e550229a158bfd32.js integrity="sha256-+RMnlDAaAf8WVQ7WZ2NIK9hI9iJD0nj15VAimhWL/TI=" crossorigin=anonymous></script>
<script type=text/javascript src=/js/anatole-theme-switcher.min.d6d329d93844b162e8bed1e915619625ca91687952177552b9b3e211014a2957.js integrity="sha256-1tMp2ThEsWLovtHpFWGWJcqRaHlSF3VSubPiEQFKKVc=" crossorigin=anonymous></script><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://JiuJiuJiuge.github.io/images/site-feature-image.png"><meta name=twitter:title content="Change in soil phosphorous distribution and bioavailability within water-stable aggregates under long-term Camellia Oleifera cultivation "><meta name=twitter:description content="Change in soil phosphorous distribution and bioavailability within water-stable aggregates under long-term *Camellia Oleifera* cultivation"><meta property="og:title" content="Change in soil phosphorous distribution and bioavailability within water-stable aggregates under long-term Camellia Oleifera cultivation "><meta property="og:description" content="Change in soil phosphorous distribution and bioavailability within water-stable aggregates under long-term *Camellia Oleifera* cultivation"><meta property="og:type" content="article"><meta property="og:url" content="https://JiuJiuJiuge.github.io/code/code2/"><meta property="og:image" content="https://JiuJiuJiuge.github.io/images/site-feature-image.png"><meta property="article:section" content="code"><meta property="article:published_time" content="2023-09-25T00:00:00+00:00"><meta property="article:modified_time" content="2023-09-25T00:00:00+00:00"><meta property="og:site_name" content="I'm Yukun Lu"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"code","name":"Change in soil phosphorous distribution and bioavailability within water-stable aggregates under long-term Camellia Oleifera cultivation ","headline":"Change in soil phosphorous distribution and bioavailability within water-stable aggregates under long-term Camellia Oleifera cultivation ","alternativeHeadline":"","description":"
      Change in soil phosphorous distribution and bioavailability within water-stable aggregates under long-term *Camellia Oleifera* cultivation


    ","inLanguage":"en","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/JiuJiuJiuge.github.io\/code\/code2\/"},"author":{"@type":"Person","name":"Yukun Lu"},"creator":{"@type":"Person","name":"Yukun Lu"},"accountablePerson":{"@type":"Person","name":"Yukun Lu"},"copyrightHolder":{"@type":"Person","name":"Yukun Lu"},"copyrightYear":"2023","dateCreated":"2023-09-25T00:00:00.00Z","datePublished":"2023-09-25T00:00:00.00Z","dateModified":"2023-09-25T00:00:00.00Z","publisher":{"@type":"Organization","name":"Yukun Lu","url":"https://JiuJiuJiuge.github.io","logo":{"@type":"ImageObject","url":"https:\/\/JiuJiuJiuge.github.io\/favicons\/favicon-32x32.png","width":"32","height":"32"}},"image":["https://JiuJiuJiuge.github.io/images/site-feature-image.png"],"url":"https:\/\/JiuJiuJiuge.github.io\/code\/code2\/","wordCount":"2167","genre":[],"keywords":["Submitted in Biology and Fertility of Soils"]}</script></head><body class=body><div class=wrapper><aside class=wrapper__sidebar><div class="sidebar
animated fadeInDown"><div class=sidebar__content><div class=sidebar__introduction><img class=sidebar__introduction-profileimage src=/images/hea.jpg alt="profile picture"><div class=sidebar__introduction-title><a href=/>I'm Yukun Lu</a></div><div class=sidebar__introduction-description><p>20200255@csuft.edu.cn</p></div></div><ul class=sidebar__list><li class=sidebar__list-item><a href=https://twitter.com/Arthur53295973 target=_blank rel="noopener me" aria-label=Twitter title=Twitter><i class="fab fa-twitter fa-2x" aria-hidden=true></i></a></li><li class=sidebar__list-item><a href=https://github.com/JiuJiuJiuge target=_blank rel="noopener me" aria-label=GitHub title=GitHub><i class="fab fa-github fa-2x" aria-hidden=true></i></a></li><li class=sidebar__list-item><a href=https://www.instagram.com/ljg1148260815/ target=_blank rel="noopener me" aria-label=instagram title=instagram><i class="fab fa-instagram fa-2x" aria-hidden=true></i></a></li><li class=sidebar__list-item><a href=http://www.luyukun.xyz/contact/ target=_blank rel="noopener me" aria-label=e-mail title=e-mail><i class="fas fa-envelope fa-2x" aria-hidden=true></i></a></li></ul></div><footer class="footer footer__sidebar"><ul class=footer__list><li class=footer__item>&copy;
Yukun Lu
2023</li></ul></footer><script type=text/javascript src=/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ=" crossorigin=anonymous></script></div></aside><main class=wrapper__main><header class=header><div class="animated fadeInDown"><a role=button class=navbar-burger data-target=navMenu aria-label=menu aria-expanded=false><span aria-hidden=true class=navbar-burger__line></span>
<span aria-hidden=true class=navbar-burger__line></span>
<span aria-hidden=true class=navbar-burger__line></span></a><nav class=nav><ul class=nav__list id=navMenu><li class=nav__list-item><a href=/ title>Home</a></li><li class=nav__list-item><div class=optionswitch><input class=optionswitch__picker type=checkbox id=1 hidden>
<label class=optionswitch__label for=1>Academic <i class="fa fa-angle-down" aria-hidden=true></i></label><div class=optionswitch__triangle></div><ul class=optionswitch__list><li class=optionswitch__list-item><a href=/papers/ title>Papers</a></li><li class=optionswitch__list-item><a href=/code/ title>Code</a></li></ul></div></li><li class=nav__list-item><a href=/work/ title>Work</a></li><li class=nav__list-item><a href=/awards/ title>Awards</a></li><li class=nav__list-item><a href=/life/ title>Life</a></li><li class=nav__list-item><a href=/contact/ title>Contact</a></li></ul><ul class="nav__list nav__list--end"><li class=nav__list-item><div class=themeswitch><a title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></li></ul></nav></div></header><div class="post
animated fadeInDown"><div class=post__content><h1>Change in Soil Phosphorous Distribution and Bioavailability Within Water-Stable Aggregates Under Long-Term Camellia Oleifera Cultivation</h1><h2 id=fig1><strong>Fig1</strong></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#Python</span>
</span></span><span class=line><span class=cl><span class=c1>#Fig1(b)</span>
</span></span><span class=line><span class=cl><span class=c1># Import necessary libraries</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>seaborn</span> <span class=k>as</span> <span class=nn>sns</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>geopandas</span> <span class=k>as</span> <span class=nn>gp</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>shapely.geometry</span> <span class=kn>import</span> <span class=n>Point</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib</span> <span class=k>as</span> <span class=nn>mpt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the font family for matplotlib</span>
</span></span><span class=line><span class=cl><span class=n>mpt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;font.family&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;Times New Roman&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Read data from an Excel file named &#34;BAF.xlsx&#34;</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_excel</span><span class=p>(</span><span class=s2>&#34;BAF.xlsx&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a bar plot figure with a specified size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Define a color dictionary for age groups</span>
</span></span><span class=line><span class=cl><span class=n>dict_color</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span><span class=n>Chi</span><span class=o>=</span><span class=s2>&#34;#dbe2ef&#34;</span><span class=p>,</span> <span class=n>You</span><span class=o>=</span><span class=s2>&#34;#3f72af&#34;</span><span class=p>,</span> <span class=n>Old</span><span class=o>=</span><span class=s2>&#34;#112d4e&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a bar plot using Seaborn</span>
</span></span><span class=line><span class=cl><span class=n>sns</span><span class=o>.</span><span class=n>barplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;size&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;BAF&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>hue</span><span class=o>=</span><span class=s1>&#39;age&#39;</span><span class=p>,</span> <span class=n>palette</span><span class=o>=</span><span class=n>dict_color</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>capsize</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>saturation</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>errcolor</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>,</span> <span class=n>errwidth</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>ci</span><span class=o>=</span><span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set x and y axis labels</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Soil aggregate size (mm)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;BAF (%)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the y-axis limits</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add a legend with specified location, frame, and font size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>loc</span><span class=o>=</span><span class=s1>&#39;best&#39;</span><span class=p>,</span> <span class=n>frameon</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>,</span> <span class=n>ncol</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set tick label font size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>labelsize</span><span class=o>=</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save the figure to a file with a specified format, tight layout, and DPI</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Fig/BCF.jpg&#34;</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s2>&#34;tight&#34;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>600</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#Same with Fig1(a)</span>
</span></span></code></pre></div><h2 id=fig2>Fig2</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#Python</span>
</span></span><span class=line><span class=cl><span class=c1>#Fig2(a) LM</span>
</span></span><span class=line><span class=cl><span class=c1># Import necessary libraries</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>seaborn</span> <span class=k>as</span> <span class=nn>sns</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>geopandas</span> <span class=k>as</span> <span class=nn>gp</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>shapely</span> <span class=n>geometry</span> <span class=kn>import</span> <span class=nn>Point</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib</span> <span class=k>as</span> <span class=nn>mpt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the font family for matplotlib</span>
</span></span><span class=line><span class=cl><span class=n>mpt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;font.family&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;Times New Roman&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Read data from an Excel file named &#34;Pcontent.xlsx&#34;</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_excel</span><span class=p>(</span><span class=s2>&#34;Pcontent.xlsx&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a bar plot figure with a specified size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Define a color dictionary for age groups</span>
</span></span><span class=line><span class=cl><span class=n>dict_color</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span><span class=n>Chi</span><span class=o>=</span><span class=s2>&#34;#caddd1&#34;</span><span class=p>,</span> <span class=n>You</span><span class=o>=</span><span class=s2>&#34;#719f85&#34;</span><span class=p>,</span> <span class=n>Old</span><span class=o>=</span><span class=s2>&#34;#4a565f&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a bar plot using Seaborn</span>
</span></span><span class=line><span class=cl><span class=n>sns</span><span class=o>.</span><span class=n>barplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;P&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;concentration&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>hue</span><span class=o>=</span><span class=s1>&#39;age&#39;</span><span class=p>,</span> <span class=n>palette</span><span class=o>=</span><span class=n>dict_color</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>capsize</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>saturation</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>errcolor</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>,</span> <span class=n>errwidth</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>ci</span><span class=o>=</span><span class=mi>95</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set x and y axis labels</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;Concentrations of soil-P fraction (mg·kg$^{-1}$)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the y-axis limits</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set x-axis tick labels</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>set_xticklabels</span><span class=p>([</span><span class=s1>&#39;Al-P&#39;</span><span class=p>,</span> <span class=s1>&#39;Fe-P&#39;</span><span class=p>,</span> <span class=s1>&#39;O-P&#39;</span><span class=p>,</span> <span class=s1>&#39;Ca-P&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add a legend with specified location, frame, and font size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>loc</span><span class=o>=</span><span class=s1>&#39;best&#39;</span><span class=p>,</span> <span class=n>frameon</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set tick label font size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>labelsize</span><span class=o>=</span><span class=mi>17</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save the figure to a file with a specified format, tight layout, and DPI</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Fig/LM.jpg&#34;</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s2>&#34;tight&#34;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>600</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#Same with others</span>
</span></span></code></pre></div><h2 id=fig3>Fig3</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#Python</span>
</span></span><span class=line><span class=cl><span class=c1>#Fig3(a)</span>
</span></span><span class=line><span class=cl><span class=c1># Import necessary libraries</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>seaborn</span> <span class=k>as</span> <span class=nn>sns</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.metrics</span> <span class=kn>import</span> <span class=n>r2_score</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Read data from an Excel file</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_excel</span><span class=p>(</span><span class=s2>&#34;absorb.xlsx&#34;</span><span class=p>,</span><span class=n>sheet_name</span><span class=o>=</span><span class=s1>&#39;LM&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Define a Langmuir adsorption model function</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>langmuir</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>a</span> <span class=o>*</span> <span class=n>x</span> <span class=o>*</span> <span class=n>b</span> <span class=o>/</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>b</span> <span class=o>*</span> <span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Define a dictionary for custom colors based on age groups</span>
</span></span><span class=line><span class=cl><span class=n>dict_color</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span><span class=n>Chi</span><span class=o>=</span><span class=s2>&#34;#ff5959&#34;</span><span class=p>,</span> <span class=n>You</span><span class=o>=</span><span class=s2>&#34;#ffad5a&#34;</span><span class=p>,</span> <span class=n>Old</span><span class=o>=</span><span class=s2>&#34;#4f9da6&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a Seaborn FacetGrid for plotting</span>
</span></span><span class=line><span class=cl><span class=n>g</span> <span class=o>=</span> <span class=n>sns</span><span class=o>.</span><span class=n>FacetGrid</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>hue</span><span class=o>=</span><span class=s1>&#39;age&#39;</span><span class=p>,</span> <span class=n>palette</span><span class=o>=</span><span class=n>dict_color</span><span class=p>,</span> <span class=n>height</span><span class=o>=</span><span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Plot scatter points on the FacetGrid</span>
</span></span><span class=line><span class=cl><span class=n>g</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=n>sns</span><span class=o>.</span><span class=n>scatterplot</span><span class=p>,</span> <span class=s1>&#39;P&#39;</span><span class=p>,</span> <span class=s1>&#39;absorb&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>60</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s2>&#34;black&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>zorder</span><span class=o>=-</span><span class=mi>30</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Generate x values for the Langmuir model curve</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>line_width</span> <span class=o>=</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>line_alpha</span> <span class=o>=</span> <span class=mf>0.7</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Iterate through unique age groups in the data</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>age_group</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>unique</span><span class=p>()):</span>
</span></span><span class=line><span class=cl>    <span class=n>age_data</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>age_group</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Perform curve fitting using the Langmuir model</span>
</span></span><span class=line><span class=cl>    <span class=n>popt</span><span class=p>,</span> <span class=n>pcov</span> <span class=o>=</span> <span class=n>curve_fit</span><span class=p>(</span><span class=n>langmuir</span><span class=p>,</span> <span class=n>age_data</span><span class=p>[</span><span class=s1>&#39;P&#39;</span><span class=p>],</span> <span class=n>age_data</span><span class=p>[</span><span class=s1>&#39;absorb&#39;</span><span class=p>],</span> <span class=n>p0</span><span class=o>=</span><span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>y_fit</span> <span class=o>=</span> <span class=n>langmuir</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=o>*</span><span class=n>popt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Calculate and print the R-squared value for the fit</span>
</span></span><span class=line><span class=cl>    <span class=n>r2</span> <span class=o>=</span> <span class=n>r2_score</span><span class=p>(</span><span class=n>age_data</span><span class=p>[</span><span class=s1>&#39;absorb&#39;</span><span class=p>],</span> <span class=n>langmuir</span><span class=p>(</span><span class=n>age_data</span><span class=p>[</span><span class=s1>&#39;P&#39;</span><span class=p>],</span> <span class=o>*</span><span class=n>popt</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>age_group</span><span class=si>}</span><span class=s2> curve fit: a=</span><span class=si>{</span><span class=n>popt</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>, b=</span><span class=si>{</span><span class=n>popt</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>, R^2=</span><span class=si>{</span><span class=n>r2</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Plot the fitted curve for the age group</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y_fit</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>dict_color</span><span class=p>[</span><span class=n>age_group</span><span class=p>],</span> <span class=n>lw</span><span class=o>=</span><span class=n>line_width</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=n>line_alpha</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>age_group</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set y-axis limits and ticks</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>(</span><span class=o>-</span><span class=mi>100</span><span class=p>,</span> <span class=mi>1900</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>yticks</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>400</span><span class=p>,</span> <span class=mi>800</span><span class=p>,</span> <span class=mi>1200</span><span class=p>,</span> <span class=mi>1600</span><span class=p>,</span> <span class=mi>2000</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set x-axis ticks</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xticks</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set x and y-axis labels and tick label sizes</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Equilibrium concentration (mg·L$^{-1}$)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>25</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;Adsorption quantity (mg·kg$^{-1}$)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>25</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>labelsize</span><span class=o>=</span><span class=mi>22</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Remove unnecessary plot borders</span>
</span></span><span class=line><span class=cl><span class=n>sns</span><span class=o>.</span><span class=n>despine</span><span class=p>(</span><span class=n>top</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>right</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>left</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>bottom</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save the figure to a file</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Fig/LM.jpg&#34;</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s2>&#34;tight&#34;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>600</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># Same as others</span>
</span></span></code></pre></div><h2 id=fig4a>Fig4(a)</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python</span>
</span></span><span class=line><span class=cl><span class=c1># Import necessary libraries</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>geopandas</span> <span class=k>as</span> <span class=nn>gp</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>shapely.geometry</span> <span class=kn>import</span> <span class=n>Point</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>matplotlib.colors</span> <span class=kn>import</span> <span class=n>ListedColormap</span> 
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>seaborn</span> <span class=k>as</span> <span class=nn>sns</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib</span> <span class=k>as</span> <span class=nn>mpt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>libtiff</span> <span class=kn>import</span> <span class=n>TIFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the font family for matplotlib</span>
</span></span><span class=line><span class=cl><span class=n>mpt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;font.family&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;Times New Roman&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Read data from an Excel file named &#34;adata.xlsx&#34; from different sheets</span>
</span></span><span class=line><span class=cl><span class=n>data2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_excel</span><span class=p>(</span><span class=s2>&#34;adata.xlsx&#34;</span><span class=p>,</span> <span class=n>sheet_name</span><span class=o>=</span><span class=s1>&#39;Mi&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>data1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_excel</span><span class=p>(</span><span class=s2>&#34;adata.xlsx&#34;</span><span class=p>,</span> <span class=n>sheet_name</span><span class=o>=</span><span class=s1>&#39;SM&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_excel</span><span class=p>(</span><span class=s2>&#34;adata.xlsx&#34;</span><span class=p>,</span> <span class=n>sheet_name</span><span class=o>=</span><span class=s1>&#39;LM&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a figure with a specified size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a regression plot with confidence interval and scatter plot for data2</span>
</span></span><span class=line><span class=cl><span class=n>sns</span><span class=o>.</span><span class=n>regplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;SOM&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;AlP&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data2</span><span class=p>,</span> <span class=n>ci</span><span class=o>=</span><span class=mi>95</span><span class=p>,</span> <span class=n>order</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>line_kws</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=s2>&#34;#ec748b&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>lw</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>zorder</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;-&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>scatter_kws</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>s</span><span class=o>=</span><span class=mf>0.00000001</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.04</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>zorder</span><span class=o>=-</span><span class=mi>50</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a scatter plot for data2</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s2>&#34;SOM&#34;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s2>&#34;AlP&#34;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data2</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;#ec748b&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>,</span> <span class=n>vmin</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>vmax</span><span class=o>=</span><span class=mf>1.8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a regression plot with confidence interval and scatter plot for data1</span>
</span></span><span class=line><span class=cl><span class=n>sns</span><span class=o>.</span><span class=n>regplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;SOM&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;AlP&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data1</span><span class=p>,</span> <span class=n>ci</span><span class=o>=</span><span class=mi>95</span><span class=p>,</span> <span class=n>order</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>line_kws</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=s2>&#34;#6eb1de&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>lw</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>zorder</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;-&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>scatter_kws</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>s</span><span class=o>=</span><span class=mf>0.00000001</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.04</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>zorder</span><span class=o>=-</span><span class=mi>50</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a scatter plot for data1</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s2>&#34;SOM&#34;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s2>&#34;AlP&#34;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data1</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;#6eb1de&#34;</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>,</span> <span class=n>vmin</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>vmax</span><span class=o>=</span><span class=mf>1.8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a regression plot with confidence interval and scatter plot for data</span>
</span></span><span class=line><span class=cl><span class=n>sns</span><span class=o>.</span><span class=n>regplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;SOM&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;AlP&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>ci</span><span class=o>=</span><span class=mi>95</span><span class=p>,</span> <span class=n>order</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>line_kws</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=s2>&#34;#6bb952&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>lw</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>zorder</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;-&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>scatter_kws</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>s</span><span class=o>=</span><span class=mf>0.00000001</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.04</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>zorder</span><span class=o>=-</span><span class=mi>50</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a scatter plot for data</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s2>&#34;SOM&#34;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s2>&#34;AlP&#34;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;#6bb952&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>,</span> <span class=n>vmin</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>vmax</span><span class=o>=</span><span class=mf>1.8</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>40</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set y-axis and x-axis labels</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;Al-P (mg·kg$^{-1}$)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>22</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;SOM (g·kg$^{-1}$)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>22</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1># Set y-axis limits and ticks</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>(</span><span class=o>-</span><span class=mi>15</span><span class=p>,</span> <span class=mi>30</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>yticks</span><span class=p>([</span><span class=o>-</span><span class=mi>15</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>30</span><span class=p>])</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set tick label font size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>labelsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add a legend with specified location, frame, font size, and other properties</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>loc</span><span class=o>=</span><span class=s2>&#34;right&#34;</span><span class=p>,</span> <span class=n>frameon</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>,</span> <span class=n>markerscale</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>bbox_to_anchor</span><span class=o>=</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mf>0.0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save the figure to a file with a specified format, tight layout, and DPI</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Fig/alp_som.jpg&#34;</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s2>&#34;tight&#34;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>600</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># Same as others</span>
</span></span></code></pre></div><h2 id=fig4b>Fig4(b)</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># The slope and significance were calculated using SPSS in advance</span>
</span></span><span class=line><span class=cl><span class=c1># Import necessary libraries</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>geopandas</span> <span class=k>as</span> <span class=nn>gp</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>shapely.geometry</span> <span class=kn>import</span> <span class=n>Point</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>matplotlib.colors</span> <span class=kn>import</span> <span class=n>ListedColormap</span> 
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>seaborn</span> <span class=k>as</span> <span class=nn>sns</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib</span> <span class=k>as</span> <span class=nn>mpt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>libtiff</span> <span class=kn>import</span> <span class=n>TIFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a bar plot figure with a specified size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Define the x-axis values and the corresponding slopes</span>
</span></span><span class=line><span class=cl><span class=n>index</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>values</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.22</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mf>0.09</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.41</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a bar plot with specified colors</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>index</span><span class=p>,</span> <span class=n>values</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;#6bb952&#34;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s2>&#34;#6eb1de&#34;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s2>&#34;#ec748b&#34;</span><span class=p>],</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set y-axis and x-axis limits and ticks</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>(</span><span class=o>-</span><span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlim</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xticks</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>])</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set x-axis tick labels</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>set_xticklabels</span><span class=p>([</span><span class=s1>&#39;&gt; 2&#39;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s1>&#39;2-0.25&#39;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s1>&#39;&lt; 0.25&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set x and y axis labels</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Soil aggregate size (mm)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>22</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;Slope&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>22</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set tick label font size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>labelsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add a horizontal line at y=0 for reference</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s2>&#34;:&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save the figure to a file with a specified format, tight layout, and DPI</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Fig/alp_slope.jpg&#34;</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s2>&#34;tight&#34;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>600</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># Same as ohters</span>
</span></span></code></pre></div><h2 id=fig5a>Fig5(a)</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#Python</span>
</span></span><span class=line><span class=cl><span class=c1>#Fig5(a)</span>
</span></span><span class=line><span class=cl><span class=c1># Import necessary libraries</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>geopandas</span> <span class=k>as</span> <span class=nn>gp</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>shapely.geometry</span> <span class=kn>import</span> <span class=n>Point</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>seaborn</span> <span class=k>as</span> <span class=nn>sns</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib</span> <span class=k>as</span> <span class=nn>mpt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>libtiff</span> <span class=kn>import</span> <span class=n>TIFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the font family for matplotlib</span>
</span></span><span class=line><span class=cl><span class=n>mpt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;font.family&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;Times New Roman&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Read data from an Excel file named &#34;adata.xlsx&#34; from the &#39;line&#39; sheet</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_excel</span><span class=p>(</span><span class=s2>&#34;adata.xlsx&#34;</span><span class=p>,</span> <span class=n>sheet_name</span><span class=o>=</span><span class=s1>&#39;line&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a figure with a specified size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a regression plot with confidence interval and scatter plot for &#39;AlP&#39; vs. &#39;C=C&#39;</span>
</span></span><span class=line><span class=cl><span class=n>sns</span><span class=o>.</span><span class=n>regplot</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=s1>&#39;C=C&#39;</span><span class=p>,</span> <span class=n>x</span><span class=o>=</span><span class=s1>&#39;AlP&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>ci</span><span class=o>=</span><span class=mi>95</span><span class=p>,</span> <span class=n>order</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>line_kws</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=s2>&#34;#3951A2&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>lw</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>zorder</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;-&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>scatter_kws</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>s</span><span class=o>=</span><span class=mf>0.00000001</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.04</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>zorder</span><span class=o>=-</span><span class=mi>50</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a scatter plot for &#39;AlP&#39; vs. &#39;C=C&#39;</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=s2>&#34;C=C&#34;</span><span class=p>,</span> <span class=n>x</span><span class=o>=</span><span class=s2>&#34;AlP&#34;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;#3951A2&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s2>&#34;black&#34;</span><span class=p>,</span> <span class=n>vmin</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>vmax</span><span class=o>=</span><span class=mf>1.8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create regression plots and scatter plots for other variables (&#39;FeP&#39;, &#39;OP&#39;, &#39;CaP&#39;)</span>
</span></span><span class=line><span class=cl><span class=n>sns</span><span class=o>.</span><span class=n>regplot</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=s1>&#39;C=C&#39;</span><span class=p>,</span> <span class=n>x</span><span class=o>=</span><span class=s1>&#39;FeP&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>ci</span><span class=o>=</span><span class=mi>95</span><span class=p>,</span> <span class=n>order</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>line_kws</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=s2>&#34;#72AACF&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>lw</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>zorder</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;-&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>scatter_kws</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>s</span><span class=o>=</span><span class=mf>0.00000001</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.04</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>zorder</span><span class=o>=-</span><span class=mi>50</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=s2>&#34;C=C&#34;</span><span class=p>,</span> <span class=n>x</span><span class=o>=</span><span class=s2>&#34;FeP&#34;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;#72AACF&#34;</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>,</span> <span class=n>vmin</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>vmax</span><span class=o>=</span><span class=mf>1.8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sns</span><span class=o>.</span><span class=n>regplot</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=s1>&#39;C=C&#39;</span><span class=p>,</span> <span class=n>x</span><span class=o>=</span><span class=s1>&#39;OP&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>ci</span><span class=o>=</span><span class=mi>95</span><span class=p>,</span> <span class=n>order</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>line_kws</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=s2>&#34;#FDB96B&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>lw</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>zorder</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;-&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>scatter_kws</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>s</span><span class=o>=</span><span class=mf>0.00000001</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.04</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>zorder</span><span class=o>=-</span><span class=mi>50</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=s2>&#34;C=C&#34;</span><span class=p>,</span> <span class=n>x</span><span class=o>=</span><span class=s2>&#34;OP&#34;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;#FDB96B&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>,</span> <span class=n>vmin</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>vmax</span><span class=o>=</span><span class=mf>1.8</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>40</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sns</span><span class=o>.</span><span class=n>regplot</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=s1>&#39;C=C&#39;</span><span class=p>,</span> <span class=n>x</span><span class=o>=</span><span class=s1>&#39;CaP&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>ci</span><span class=o>=</span><span class=mi>95</span><span class=p>,</span> <span class=n>order</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>line_kws</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=s2>&#34;#EC5D3B&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>lw</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>zorder</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;-&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>scatter_kws</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>s</span><span class=o>=</span><span class=mf>0.00000001</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.04</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>zorder</span><span class=o>=-</span><span class=mi>50</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=s2>&#34;C=C&#34;</span><span class=p>,</span> <span class=n>x</span><span class=o>=</span><span class=s2>&#34;CaP&#34;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;#EC5D3B&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>,</span> <span class=n>vmin</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>vmax</span><span class=o>=</span><span class=mf>1.8</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>40</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set x and y axis labels</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Content (mg·kg$^{-1}$)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>22</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;C=C (%)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>22</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set x and y axis limits and ticks</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlim</span><span class=p>(</span><span class=o>-</span><span class=mi>10</span><span class=p>,</span> <span class=mi>60</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>(</span><span class=o>-</span><span class=mi>40</span><span class=p>,</span> <span class=mi>80</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>yticks</span><span class=p>([</span><span class=o>-</span><span class=mi>40</span><span class=p>,</span> <span class=o>-</span><span class=mi>20</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>80</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set tick label font size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>labelsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save the figure to a file with a specified format, tight layout, and DPI</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Fig/total_C=C.jpg&#34;</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s2>&#34;tight&#34;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>600</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#Same as Fig5(b)</span>
</span></span></code></pre></div><h2 id=fig5c>Fig5(c)</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#Calculate the slope and significance using SPSS in advance</span>
</span></span><span class=line><span class=cl><span class=c1># Import necessary libraries</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>geopandas</span> <span class=k>as</span> <span class=nn>gp</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>shapely.geometry</span> <span class=kn>import</span> <span class=n>Point</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>seaborn</span> <span class=k>as</span> <span class=nn>sns</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib</span> <span class=k>as</span> <span class=nn>mpt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>libtiff</span> <span class=kn>import</span> <span class=n>TIFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a bar plot figure with a specified size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Define the x-axis values and the corresponding slopes</span>
</span></span><span class=line><span class=cl><span class=n>index</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>values</span> <span class=o>=</span> <span class=p>[</span><span class=o>-</span><span class=mf>0.898</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.641</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.489</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.352</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a bar plot with specified colors</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>index</span><span class=p>,</span> <span class=n>values</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;#3951A2&#34;</span><span class=p>,</span> <span class=s1>&#39;#72AACF&#39;</span><span class=p>,</span> <span class=s2>&#34;#FDB96B&#34;</span><span class=p>,</span> <span class=s2>&#34;#EC5D3B&#34;</span><span class=p>],</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set y-axis and x-axis limits and ticks</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>(</span><span class=o>-</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>yticks</span><span class=p>([</span><span class=o>-</span><span class=mi>2</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlim</span><span class=p>(</span><span class=o>-</span><span class=mf>0.8</span><span class=p>,</span> <span class=mf>3.8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xticks</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set x-axis tick labels</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>set_xticklabels</span><span class=p>([</span><span class=s1>&#39;Al-P&#39;</span><span class=p>,</span> <span class=s2>&#34;Fe-P&#34;</span><span class=p>,</span> <span class=s1>&#39;O-P&#39;</span><span class=p>,</span> <span class=s2>&#34;Ca-P&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set x and y axis labels</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>22</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;Slope&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>22</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set tick label font size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>labelsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add a horizontal line at y=0 for reference</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s2>&#34;:&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save the figure to a file with a specified format, tight layout, and DPI</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Fig/totalC=C_slope.jpg&#34;</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s2>&#34;tight&#34;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>600</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># Same as Fig5(d)</span>
</span></span></code></pre></div><h2 id=fig6>Fig6</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#Python</span>
</span></span><span class=line><span class=cl><span class=c1>#Fig6(a)</span>
</span></span><span class=line><span class=cl><span class=c1># Import necessary libraries</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>seaborn</span> <span class=k>as</span> <span class=nn>sns</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>geopandas</span> <span class=k>as</span> <span class=nn>gp</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>shapely.geometry</span> <span class=kn>import</span> <span class=n>Point</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib</span> <span class=k>as</span> <span class=nn>mpt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the font family for matplotlib</span>
</span></span><span class=line><span class=cl><span class=n>mpt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;font.family&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;Times New Roman&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Read data from an Excel file named &#34;enzyme.xlsx&#34; from the &#39;ACP&#39; sheet</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_excel</span><span class=p>(</span><span class=s2>&#34;enzyme.xlsx&#34;</span><span class=p>,</span> <span class=n>sheet_name</span><span class=o>=</span><span class=s1>&#39;ACP&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a bar plot figure with a specified size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Define a color dictionary for age groups</span>
</span></span><span class=line><span class=cl><span class=n>dict_color</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span><span class=n>Chi</span><span class=o>=</span><span class=s2>&#34;#d0eef4&#34;</span><span class=p>,</span> <span class=n>You</span><span class=o>=</span><span class=s2>&#34;#7bd3d4&#34;</span><span class=p>,</span> <span class=n>Old</span><span class=o>=</span><span class=s2>&#34;#208993&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a bar plot using Seaborn</span>
</span></span><span class=line><span class=cl><span class=n>sns</span><span class=o>.</span><span class=n>barplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;size&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;ACP&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>hue</span><span class=o>=</span><span class=s1>&#39;age&#39;</span><span class=p>,</span> <span class=n>palette</span><span class=o>=</span><span class=n>dict_color</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>capsize</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>saturation</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>errcolor</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>,</span> <span class=n>errwidth</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>ci</span><span class=o>=</span><span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set x and y axis labels</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Soil aggregate size (mm)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;ACP (mg·g$^{-1}$)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the y-axis limits and ticks</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>40</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>yticks</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>40</span><span class=p>])</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add a legend with specified location, frame, and font size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>loc</span><span class=o>=</span><span class=s1>&#39;best&#39;</span><span class=p>,</span> <span class=n>frameon</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add text to indicate the subplot as &#34;(a)&#34;</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=o>-</span><span class=mf>0.40</span><span class=p>,</span> <span class=mi>36</span><span class=p>,</span> <span class=s2>&#34;(a)&#34;</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set tick label font size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>labelsize</span><span class=o>=</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save the figure to a file with a specified format, tight layout, and DPI</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Fig/ACP.jpg&#34;</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s2>&#34;tight&#34;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>600</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># Same as others</span>
</span></span></code></pre></div><h2 id=fig8>Fig8</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=c1># R</span>
</span></span><span class=line><span class=cl><span class=c1># TITAN package usage</span>
</span></span><span class=line><span class=cl><span class=nf>rm</span><span class=p>(</span><span class=n>list</span> <span class=o>=</span> <span class=nf>ls</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>TITAN2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>data1</span><span class=o>&lt;-</span> <span class=nf>read.delim</span><span class=p>(</span><span class=s>&#34;D:/titan/taxa2.txt&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>rownames</span><span class=p>(</span><span class=n>data1</span><span class=p>)</span><span class=o>&lt;-</span><span class=n>data1[</span><span class=p>,</span><span class=m>1</span><span class=n>]</span> 
</span></span><span class=line><span class=cl><span class=n>data1</span><span class=o>&lt;-</span><span class=n>data1[</span><span class=p>,</span><span class=m>-1</span><span class=n>]</span> 
</span></span><span class=line><span class=cl><span class=nf>head</span><span class=p>(</span><span class=n>data1</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>data2</span><span class=o>&lt;-</span> <span class=nf>read.delim</span><span class=p>(</span><span class=s>&#34;D:/titan/AlP.txt&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>rownames</span><span class=p>(</span><span class=n>data2</span><span class=p>)</span><span class=o>&lt;-</span><span class=n>data2[</span><span class=p>,</span><span class=m>1</span><span class=n>]</span> 
</span></span><span class=line><span class=cl><span class=n>data2</span><span class=o>&lt;-</span><span class=n>data2[</span><span class=p>,</span><span class=m>-1</span><span class=n>]</span> 
</span></span><span class=line><span class=cl><span class=nf>head</span><span class=p>(</span><span class=n>data2</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=nf>titan</span><span class=p>(</span><span class=n>data2</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>            <span class=n>data1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>minSplt</span> <span class=o>=</span> <span class=m>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>numPerm</span> <span class=o>=</span> <span class=m>500</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>boot</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>nBoot</span> <span class=o>=</span> <span class=m>500</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>imax</span> <span class=o>=</span> <span class=kc>FALSE</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>ivTot</span> <span class=o>=</span> <span class=kc>FALSE</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>pur.cut</span> <span class=o>=</span> <span class=m>0.95</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>rel.cut</span> <span class=o>=</span> <span class=m>0.95</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>ncpus</span> <span class=o>=</span> <span class=m>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>memory</span> <span class=o>=</span> <span class=kc>FALSE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>file_path</span> <span class=o>&lt;-</span> <span class=s>&#34;D:/titan/last/alp_real_taxa.csv&#34;</span>
</span></span><span class=line><span class=cl><span class=nf>write.csv</span><span class=p>(</span><span class=n>res[</span><span class=s>&#39;sppmax&#39;</span><span class=n>]</span><span class=p>,</span> <span class=n>file</span> <span class=o>=</span> <span class=n>file_path</span><span class=p>,</span> <span class=n>row.names</span> <span class=o>=</span> <span class=kc>FALSE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>plot_taxa_ridges</span><span class=p>(</span><span class=n>res</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>xlabel</span> <span class=o>=</span> <span class=nf>expression</span><span class=p>(</span><span class=nf>paste</span><span class=p>(</span><span class=s>&#34;The content of Ca-P (mg/g)&#34;</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>                 <span class=n>n_ytaxa</span> <span class=o>=</span> <span class=m>50</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>ytxt.sz</span> <span class=o>=</span> <span class=m>0.01</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=c1>#xlim=c(2.5,10),</span>
</span></span><span class=line><span class=cl>                 <span class=c1>#z1_fill_low=0,</span>
</span></span><span class=line><span class=cl>                 <span class=c1>#z1_fill_high=6.5,</span>
</span></span><span class=line><span class=cl>                 <span class=c1>#z2_fill_low=0,</span>
</span></span><span class=line><span class=cl>                 <span class=c1>#z2_fill_high=5,</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=c1># R</span>
</span></span><span class=line><span class=cl><span class=c1># ggplot usage</span>
</span></span><span class=line><span class=cl><span class=nf>rm</span><span class=p>(</span><span class=n>list</span> <span class=o>=</span> <span class=nf>ls</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>ggplot2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dax</span><span class=o>&lt;-</span> <span class=nf>read.delim</span><span class=p>(</span><span class=s>&#34;D:/titan/last/alp_real_taxa.txt&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>ggplot</span><span class=p>(</span> <span class=p>)</span><span class=o>+</span>
</span></span><span class=line><span class=cl>  <span class=c1>#geom_text(data=dax,aes(x=ord+0.5, y=zenv.cp+2, label = class,color = class), size = 3)+</span>
</span></span><span class=line><span class=cl>  <span class=nf>geom_pointrange</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=n>dax</span><span class=p>,</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>ord</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>zenv.cp</span><span class=p>,</span> <span class=n>ymin</span><span class=o>=</span><span class=n>X5.</span><span class=p>,</span> <span class=n>ymax</span><span class=o>=</span><span class=n>X95.</span><span class=p>,</span><span class=n>color</span> <span class=o>=</span> <span class=n>Phyla</span><span class=p>,</span> <span class=n>shape</span> <span class=o>=</span> <span class=n>Titan</span><span class=p>,</span> <span class=n>linetype</span><span class=o>=</span><span class=n>Titan</span><span class=p>),</span> <span class=n>size</span> <span class=o>=</span><span class=m>0.8</span><span class=p>)</span><span class=o>+</span>
</span></span><span class=line><span class=cl>  <span class=nf>scale_shape_manual</span><span class=p>(</span><span class=n>values</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=m>16</span><span class=p>,</span> <span class=m>1</span><span class=p>))</span> <span class=o>+</span> <span class=nf>coord_flip</span><span class=p>()</span> <span class=o>+</span> <span class=nf>ylab</span><span class=p>(</span><span class=s>&#34;Al-P (mg/g)&#34;</span><span class=p>)</span> <span class=o>+</span> <span class=nf>xlab</span><span class=p>(</span><span class=s>&#34;OTUs&#34;</span><span class=p>)</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>  <span class=nf>scale_y_continuous</span><span class=p>(</span><span class=n>breaks</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=m>24</span><span class=p>,</span><span class=m>26</span><span class=p>,</span><span class=m>28</span><span class=p>,</span><span class=m>30</span><span class=p>,</span><span class=m>32</span><span class=p>,</span><span class=m>34</span><span class=p>))</span><span class=o>+</span>
</span></span><span class=line><span class=cl>  <span class=nf>theme</span><span class=p>(</span><span class=n>panel.background</span> <span class=o>=</span> <span class=nf>element_rect</span><span class=p>(</span><span class=n>fill</span> <span class=o>=</span> <span class=kc>NA</span><span class=p>))</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>  <span class=nf>guides</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=nf>guide_legend</span><span class=p>(</span><span class=n>title</span><span class=o>=</span> <span class=s>&#34;Microbes Phylum&#34;</span><span class=p>))</span><span class=o>+</span>
</span></span><span class=line><span class=cl>  <span class=nf>theme</span><span class=p>(</span><span class=n>strip.text</span> <span class=o>=</span> <span class=nf>element_text</span><span class=p>(</span><span class=n>size</span> <span class=o>=</span> <span class=m>15</span><span class=p>,</span><span class=n>face</span><span class=o>=</span><span class=s>&#34;bold&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>legend.title</span> <span class=o>=</span> <span class=nf>element_text</span><span class=p>(</span><span class=n>colour</span><span class=o>=</span><span class=s>&#34;black&#34;</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=m>20</span><span class=p>,</span> <span class=n>face</span><span class=o>=</span><span class=s>&#34;bold&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>legend.text</span> <span class=o>=</span> <span class=nf>element_text</span><span class=p>(</span><span class=n>colour</span><span class=o>=</span><span class=s>&#34;black&#34;</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=m>20</span><span class=p>,</span> <span class=n>face</span><span class=o>=</span><span class=s>&#34;bold&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>axis.text</span> <span class=o>=</span> <span class=nf>element_text</span><span class=p>(</span><span class=n>size</span> <span class=o>=</span> <span class=m>10</span><span class=p>,</span> <span class=n>face</span> <span class=o>=</span> <span class=s>&#34;bold&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>axis.title</span><span class=o>=</span><span class=nf>element_text</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=m>20</span><span class=p>,</span><span class=n>face</span><span class=o>=</span><span class=s>&#34;bold&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>axis.line</span> <span class=o>=</span> <span class=nf>element_line</span><span class=p>(</span><span class=n>linetype</span> <span class=o>=</span> <span class=s>&#34;solid&#34;</span><span class=p>))</span><span class=o>+</span>
</span></span><span class=line><span class=cl>  <span class=nf>scale_color_manual</span><span class=p>(</span><span class=n>values</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=s>&#34;#48ad3b&#34;</span><span class=p>,</span><span class=s>&#34;#3e599a&#34;</span><span class=p>,</span><span class=s>&#34;#ff3f2e&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                              <span class=s>&#34;#ee7530&#34;</span><span class=p>,</span><span class=s>&#34;#fedf43&#34;</span><span class=p>,</span> <span class=s>&#34;#00b6c9&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                              <span class=s>&#34;#ffbec2&#34;</span><span class=p>,</span><span class=s>&#39;#236034&#39;</span><span class=p>,</span><span class=s>&#34;#B4B4D5&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                              <span class=s>&#39;#c9bcb7&#39;</span><span class=p>,</span><span class=s>&#39;#614099&#39;</span><span class=p>,</span><span class=s>&#39;#d67267&#39;</span><span class=p>))</span>
</span></span></code></pre></div><h2 id=fig9b>Fig9(b)</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=c1>#R</span>
</span></span><span class=line><span class=cl><span class=c1>#Install the plspm package</span>
</span></span><span class=line><span class=cl><span class=nf>install.packages</span><span class=p>(</span><span class=s>&#39;devtools&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>devtools</span><span class=o>::</span><span class=nf>install_github</span><span class=p>(</span><span class=s>&#39;gastonstat/plspm&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#Load the plspm package</span>
</span></span><span class=line><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>plspm</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#Read data</span>
</span></span><span class=line><span class=cl><span class=n>dat</span> <span class=o>&lt;-</span> <span class=nf>read.delim</span><span class=p>(</span><span class=s>&#34;D:/plspm/P.txt&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#Specifies the latent variable, storing the relationship between the variable and the latent variable as a list in R</span>
</span></span><span class=line><span class=cl><span class=n>dat_blocks</span> <span class=o>&lt;-</span> <span class=nf>list</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=n>Age</span> <span class=o>=</span> <span class=s>&#39;age&#39;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=n>Physical</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#39;QM&#39;</span><span class=p>,</span><span class=s>&#39;size&#39;</span><span class=p>,</span><span class=s>&#39;KCTP&#39;</span><span class=p>,</span><span class=s>&#39;Clay&#39;</span><span class=p>,</span><span class=s>&#39;Silt&#39;</span><span class=p>),</span> 
</span></span><span class=line><span class=cl>  <span class=n>Biological</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#39;OTUs&#39;</span><span class=p>,</span><span class=s>&#39;Ure&#39;</span><span class=p>,</span><span class=s>&#39;SuCr&#39;</span><span class=p>,</span><span class=s>&#39;CAT&#39;</span><span class=p>,</span><span class=s>&#39;ACP&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=n>Chemical</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#39;pH&#39;</span><span class=p>,</span><span class=s>&#39;AK&#39;</span><span class=p>,</span><span class=s>&#39;AN&#39;</span><span class=p>,</span><span class=s>&#39;SOM&#39;</span><span class=p>,</span><span class=s>&#39;CN&#39;</span><span class=p>,</span><span class=s>&#39;OH&#39;</span><span class=p>,</span><span class=s>&#39;CH&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=n>P_availability</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#39;AP&#39;</span><span class=p>,</span><span class=s>&#39;OP&#39;</span><span class=p>,</span><span class=s>&#39;AlP&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dat_blocks</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#Correlations between latent variables are described by a 0-1 matrix, where 0 represents no correlation between variables and 1 represents correlation</span>
</span></span><span class=line><span class=cl><span class=n>Age</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Physical</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=m>1</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Biological</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=m>1</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>1</span><span class=p>,</span> <span class=m>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Chemical</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=m>1</span><span class=p>,</span> <span class=m>1</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>P_availability</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=m>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dat_path</span> <span class=o>&lt;-</span> <span class=nf>rbind</span><span class=p>(</span><span class=n>Age</span><span class=p>,</span> <span class=n>Physical</span> <span class=p>,</span> <span class=n>Biological</span><span class=p>,</span><span class=n>Chemical</span><span class=p>,</span> <span class=n>P_availability</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>colnames</span><span class=p>(</span><span class=n>dat_path</span><span class=p>)</span> <span class=o>&lt;-</span> <span class=nf>rownames</span><span class=p>(</span><span class=n>dat_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dat_path</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#Specify causation</span>
</span></span><span class=line><span class=cl><span class=n>dat_modes</span> <span class=o>&lt;-</span> <span class=nf>rep</span><span class=p>(</span><span class=s>&#39;A&#39;</span><span class=p>,</span> <span class=m>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dat_modes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#Build a PLS-PM model</span>
</span></span><span class=line><span class=cl><span class=n>dat_pls</span> <span class=o>&lt;-</span> <span class=nf>plspm</span><span class=p>(</span><span class=n>dat</span><span class=p>,</span> <span class=n>dat_path</span><span class=p>,</span> <span class=n>dat_blocks</span><span class=p>,</span> <span class=n>modes</span> <span class=o>=</span> <span class=n>dat_modes</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dat_pls</span>
</span></span><span class=line><span class=cl><span class=nf>summary</span><span class=p>(</span><span class=n>dat_pls</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#View parameter estimates for path coefficients and related statistics</span>
</span></span><span class=line><span class=cl><span class=n>dat_pls</span><span class=o>$</span><span class=n>path_coefs</span>
</span></span><span class=line><span class=cl><span class=n>dat_pls</span><span class=o>$</span><span class=n>inner_model</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#View the cause-and-effect path map</span>
</span></span><span class=line><span class=cl><span class=nf>innerplot</span><span class=p>(</span><span class=n>dat_pls</span><span class=p>,</span> <span class=n>colpos</span> <span class=o>=</span> <span class=s>&#39;red&#39;</span><span class=p>,</span> <span class=n>colneg</span> <span class=o>=</span> <span class=s>&#39;blue&#39;</span><span class=p>,</span> <span class=n>show.values</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>,</span> <span class=n>lcol</span> <span class=o>=</span> <span class=s>&#39;gray&#39;</span><span class=p>,</span> <span class=n>box.lwd</span> <span class=o>=</span> <span class=m>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#View the state as an exogenous latent variable and an endogenous latent variable</span>
</span></span><span class=line><span class=cl><span class=n>dat_pls</span><span class=o>$</span><span class=n>inner_summary</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#View the influence status between variables</span>
</span></span><span class=line><span class=cl><span class=n>dat_pls</span><span class=o>$</span><span class=n>effects</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#Look at the relationship between observed and latent variables</span>
</span></span><span class=line><span class=cl><span class=n>dat_pls</span><span class=o>$</span><span class=n>outer_model</span>
</span></span><span class=line><span class=cl><span class=nf>outerplot</span><span class=p>(</span><span class=n>dat_pls</span><span class=p>,</span> <span class=n>what</span> <span class=o>=</span> <span class=s>&#39;loadings&#39;</span><span class=p>,</span> <span class=n>arr.width</span> <span class=o>=</span> <span class=m>0.1</span><span class=p>,</span> <span class=n>colpos</span> <span class=o>=</span> <span class=s>&#39;red&#39;</span><span class=p>,</span> <span class=n>colneg</span> <span class=o>=</span> <span class=s>&#39;blue&#39;</span><span class=p>,</span> <span class=n>show.values</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>,</span> <span class=n>lcol</span> <span class=o>=</span> <span class=s>&#39;gray&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>outerplot</span><span class=p>(</span><span class=n>dat_pls</span><span class=p>,</span> <span class=n>what</span> <span class=o>=</span> <span class=s>&#39;weights&#39;</span><span class=p>,</span> <span class=n>arr.width</span> <span class=o>=</span> <span class=m>0.1</span><span class=p>,</span> <span class=n>colpos</span> <span class=o>=</span> <span class=s>&#39;red&#39;</span><span class=p>,</span> <span class=n>colneg</span> <span class=o>=</span> <span class=s>&#39;blue&#39;</span><span class=p>,</span> <span class=n>show.values</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>,</span> <span class=n>lcol</span> <span class=o>=</span> <span class=s>&#39;gray&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#Evaluate model goodness</span>
</span></span><span class=line><span class=cl><span class=n>dat_pls</span><span class=o>$</span><span class=n>gof</span>
</span></span></code></pre></div></div><div class=post__footer><span><a class=tag href=/tags/submitted-in-biology-and-fertility-of-soils/>Submitted in Biology and Fertility of Soils</a></span></div></div></main></div><footer class="footer footer__base"><ul class=footer__list><li class=footer__item>&copy;
Yukun Lu
2023</li></ul></footer><script type=text/javascript src=/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ=" crossorigin=anonymous></script></body></html>