<!doctype html><html dir=ltr lang=en data-theme class="html theme--light"><head><title>Global nitrous oxide flux emissions in different climate zones |
Yukun Lu</title><meta charset=utf-8><meta name=generator content="Hugo 0.119.0"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=author content="Yukun Lu"><meta name=description content="Global nitrous oxide flux emissions in different climate zones"><link rel=stylesheet href=/scss/main.min.1147aa5bacb4bce677a0e264073829caedb82fd18ea07a5f1d80521f539d1c45.css integrity="sha256-EUeqW6y0vOZ3oOJkBzgpyu24L9GOoHpfHYBSH1OdHEU=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/css/markupHighlight.min.73ccfdf28df555e11009c13c20ced067af3cb021504cba43644c705930428b00.css integrity="sha256-c8z98o31VeEQCcE8IM7QZ688sCFQTLpDZExwWTBCiwA=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/fontawesome.min.7d272de35b410fb165377550cdf9c4d3a80fbbcc961e111914e4d5c0eaf5729f.css integrity="sha256-fSct41tBD7FlN3VQzfnE06gPu8yWHhEZFOTVwOr1cp8=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/solid.min.55d8333481b07a08e07cf6f37319753a2b47e99f4c395394c5747b48b495aa9b.css integrity="sha256-VdgzNIGwegjgfPbzcxl1OitH6Z9MOVOUxXR7SLSVqps=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/regular.min.a7448d02590b43449364b6b5922ed9af5410abb4de4238412a830316dedb850b.css integrity="sha256-p0SNAlkLQ0STZLa1ki7Zr1QQq7TeQjhBKoMDFt7bhQs=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/brands.min.9ed75a5d670c953fe4df935937674b4646f92674367e9e66eb995bb04e821647.css integrity="sha256-ntdaXWcMlT/k35NZN2dLRkb5JnQ2fp5m65lbsE6CFkc=" crossorigin=anonymous type=text/css><link rel="shortcut icon" href=/favicons/favicon.ico type=image/x-icon><link rel=apple-touch-icon sizes=180x180 href=/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicons/favicon-16x16.png><link rel=canonical href=https://JiuJiuJiuge.github.io/code/code3/><script type=text/javascript src=/js/anatole-header.min.f9132794301a01ff16550ed66763482bd848f62243d278f5e550229a158bfd32.js integrity="sha256-+RMnlDAaAf8WVQ7WZ2NIK9hI9iJD0nj15VAimhWL/TI=" crossorigin=anonymous></script>
<script type=text/javascript src=/js/anatole-theme-switcher.min.d6d329d93844b162e8bed1e915619625ca91687952177552b9b3e211014a2957.js integrity="sha256-1tMp2ThEsWLovtHpFWGWJcqRaHlSF3VSubPiEQFKKVc=" crossorigin=anonymous></script><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://JiuJiuJiuge.github.io/images/site-feature-image.png"><meta name=twitter:title content="Global nitrous oxide flux emissions in different climate zones "><meta name=twitter:description content="Global nitrous oxide flux emissions in different climate zones"><meta property="og:title" content="Global nitrous oxide flux emissions in different climate zones "><meta property="og:description" content="Global nitrous oxide flux emissions in different climate zones"><meta property="og:type" content="article"><meta property="og:url" content="https://JiuJiuJiuge.github.io/code/code3/"><meta property="og:image" content="https://JiuJiuJiuge.github.io/images/site-feature-image.png"><meta property="article:section" content="code"><meta property="article:published_time" content="2023-09-25T00:00:00+00:00"><meta property="article:modified_time" content="2023-09-25T00:00:00+00:00"><meta property="og:site_name" content="I'm Yukun Lu"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"code","name":"Global nitrous oxide flux emissions in different climate zones ","headline":"Global nitrous oxide flux emissions in different climate zones ","alternativeHeadline":"","description":"
      Global nitrous oxide flux emissions in different climate zones


    ","inLanguage":"en","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/JiuJiuJiuge.github.io\/code\/code3\/"},"author":{"@type":"Person","name":"Yukun Lu"},"creator":{"@type":"Person","name":"Yukun Lu"},"accountablePerson":{"@type":"Person","name":"Yukun Lu"},"copyrightHolder":{"@type":"Person","name":"Yukun Lu"},"copyrightYear":"2023","dateCreated":"2023-09-25T00:00:00.00Z","datePublished":"2023-09-25T00:00:00.00Z","dateModified":"2023-09-25T00:00:00.00Z","publisher":{"@type":"Organization","name":"Yukun Lu","url":"https://JiuJiuJiuge.github.io","logo":{"@type":"ImageObject","url":"https:\/\/JiuJiuJiuge.github.io\/favicons\/favicon-32x32.png","width":"32","height":"32"}},"image":["https://JiuJiuJiuge.github.io/images/site-feature-image.png"],"url":"https:\/\/JiuJiuJiuge.github.io\/code\/code3\/","wordCount":"1955","genre":[],"keywords":["Writing"]}</script></head><body class=body><div class=wrapper><aside class=wrapper__sidebar><div class="sidebar
animated fadeInDown"><div class=sidebar__content><div class=sidebar__introduction><img class=sidebar__introduction-profileimage src=/images/hea.jpg alt="profile picture"><div class=sidebar__introduction-title><a href=/>I'm Yukun Lu</a></div><div class=sidebar__introduction-description><p>20200255@csuft.edu.cn</p></div></div><ul class=sidebar__list><li class=sidebar__list-item><a href=https://twitter.com/Arthur53295973 target=_blank rel="noopener me" aria-label=Twitter title=Twitter><i class="fab fa-twitter fa-2x" aria-hidden=true></i></a></li><li class=sidebar__list-item><a href=https://github.com/JiuJiuJiuge target=_blank rel="noopener me" aria-label=GitHub title=GitHub><i class="fab fa-github fa-2x" aria-hidden=true></i></a></li><li class=sidebar__list-item><a href=https://www.instagram.com/ljg1148260815/ target=_blank rel="noopener me" aria-label=instagram title=instagram><i class="fab fa-instagram fa-2x" aria-hidden=true></i></a></li><li class=sidebar__list-item><a href=http://www.luyukun.xyz/contact/ target=_blank rel="noopener me" aria-label=e-mail title=e-mail><i class="fas fa-envelope fa-2x" aria-hidden=true></i></a></li></ul></div><footer class="footer footer__sidebar"><ul class=footer__list><li class=footer__item>&copy;
Yukun Lu
2023</li></ul></footer><script type=text/javascript src=/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ=" crossorigin=anonymous></script></div></aside><main class=wrapper__main><header class=header><div class="animated fadeInDown"><a role=button class=navbar-burger data-target=navMenu aria-label=menu aria-expanded=false><span aria-hidden=true class=navbar-burger__line></span>
<span aria-hidden=true class=navbar-burger__line></span>
<span aria-hidden=true class=navbar-burger__line></span></a><nav class=nav><ul class=nav__list id=navMenu><li class=nav__list-item><a href=/ title>Home</a></li><li class=nav__list-item><div class=optionswitch><input class=optionswitch__picker type=checkbox id=1 hidden>
<label class=optionswitch__label for=1>Academic <i class="fa fa-angle-down" aria-hidden=true></i></label><div class=optionswitch__triangle></div><ul class=optionswitch__list><li class=optionswitch__list-item><a href=/papers/ title>Papers</a></li><li class=optionswitch__list-item><a href=/code/ title>Code</a></li></ul></div></li><li class=nav__list-item><a href=/work/ title>Work</a></li><li class=nav__list-item><a href=/awards/ title>Awards</a></li><li class=nav__list-item><a href=/life/ title>Life</a></li><li class=nav__list-item><a href=/contact/ title>Contact</a></li></ul><ul class="nav__list nav__list--end"><li class=nav__list-item><div class=themeswitch><a title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></li></ul></nav></div></header><div class="post
animated fadeInDown"><div class=post__content><h1>Global Nitrous Oxide Flux Emissions in Different Climate Zones</h1><h2 id=fig1a>Fig1(a)</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#Python</span>
</span></span><span class=line><span class=cl><span class=c1>#fig map</span>
</span></span><span class=line><span class=cl><span class=c1># Import necessary libraries</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>geopandas</span> <span class=k>as</span> <span class=nn>gp</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>shapely.geometry</span> <span class=kn>import</span> <span class=n>Point</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>seaborn</span> <span class=k>as</span> <span class=nn>sns</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib</span> <span class=k>as</span> <span class=nn>mpt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>libtiff</span> <span class=kn>import</span> <span class=n>TIFF</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>calendar</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Read data</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_excel</span><span class=p>(</span><span class=s2>&#34;Sites distribution map.xlsx&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the font family for matplotlib</span>
</span></span><span class=line><span class=cl><span class=n>mpt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;font.family&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;Times New Roman&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a figure and axis with a specified size</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>12</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Load world map data from geopandas</span>
</span></span><span class=line><span class=cl><span class=n>world</span> <span class=o>=</span> <span class=n>gp</span><span class=o>.</span><span class=n>read_file</span><span class=p>(</span><span class=n>gp</span><span class=o>.</span><span class=n>datasets</span><span class=o>.</span><span class=n>get_path</span><span class=p>(</span><span class=s1>&#39;naturalearth_lowres&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Plot the world map with specific styling</span>
</span></span><span class=line><span class=cl><span class=n>world</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>ax</span><span class=o>=</span><span class=n>ax</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;white&#39;</span><span class=p>,</span> <span class=n>edgecolor</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the aspect ratio to equal for a more accurate representation</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_aspect</span><span class=p>(</span><span class=s1>&#39;equal&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create scatter plots for different data points (P1, P2, P3, P4) with specific colors, labels, and markers</span>
</span></span><span class=line><span class=cl><span class=n>P1</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;Longitude_A&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;Latitude_A&#39;</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=s2>&#34;#FB7D07&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Arid&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>45</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>P2</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;Longitude_B&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;Latitude_B&#39;</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=s2>&#34;#7CFC00&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Semi arid and humid&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>45</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>P3</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;Longitude_C&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;Latitude_C&#39;</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=s2>&#34;#0FF1F9&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Humid&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>45</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>P4</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;Longitude_D&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;Latitude_D&#39;</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=s2>&#34;#1E90FF&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Extreme humid&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>45</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set y-axis and x-axis limits and ticks</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>(</span><span class=o>-</span><span class=mi>60</span><span class=p>,</span> <span class=mi>85</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>yticks</span><span class=p>([</span><span class=o>-</span><span class=mi>50</span><span class=p>,</span> <span class=o>-</span><span class=mi>25</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>75</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlim</span><span class=p>(</span><span class=o>-</span><span class=mi>165</span><span class=p>,</span> <span class=mi>185</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xticks</span><span class=p>([</span><span class=o>-</span><span class=mi>150</span><span class=p>,</span> <span class=o>-</span><span class=mi>100</span><span class=p>,</span> <span class=o>-</span><span class=mi>50</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>150</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set tick label font size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>labelsize</span><span class=o>=</span><span class=mi>13</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add text to indicate the subplot as &#34;(a)&#34;</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=o>-</span><span class=mi>160</span><span class=p>,</span> <span class=mi>75</span><span class=p>,</span> <span class=s2>&#34;(a)&#34;</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add a legend with specified location, frame, and font size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>bbox_to_anchor</span><span class=o>=</span><span class=p>(</span><span class=mf>0.001</span><span class=p>,</span> <span class=mf>0.01</span><span class=p>),</span> <span class=n>loc</span><span class=o>=</span><span class=s1>&#39;lower left&#39;</span><span class=p>,</span> <span class=n>frameon</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>13</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save the figure to a file with a specified format, tight layout, and DPI</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Fig/sites distribution map legend.jpg&#34;</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s2>&#34;tight&#34;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>600</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=fig1b>Fig1(b)</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#Python</span>
</span></span><span class=line><span class=cl><span class=c1># Define the x-axis labels and corresponding values</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;Arid&#34;</span><span class=p>,</span> <span class=s2>&#34;Semi arid and humid&#34;</span><span class=p>,</span> <span class=s2>&#34;Humid&#34;</span><span class=p>,</span> <span class=s2>&#34;Extreme Humid&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=p>(</span><span class=mi>66</span><span class=p>,</span> <span class=mi>99</span><span class=p>,</span> <span class=mi>96</span><span class=p>,</span> <span class=mi>181</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a bar plot with specified x-axis labels and colors</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=mf>0.4</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=p>(</span><span class=s2>&#34;#FB7D07&#34;</span><span class=p>,</span> <span class=s2>&#34;#7CFC00&#34;</span><span class=p>,</span> <span class=s2>&#34;#0FF1F9&#34;</span><span class=p>,</span> <span class=s2>&#34;#1E90FF&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set tick label font size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>labelsize</span><span class=o>=</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set x and y axis labels</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Climate zones&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>17</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;Number of sites&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>17</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save the figure to a file with a specified format, tight layout, and DPI</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Fig/Fig_bar.jpg&#34;</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s2>&#34;tight&#34;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>600</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=fig1c>Fig1(c)</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python</span>
</span></span><span class=line><span class=cl><span class=c1># Arid</span>
</span></span><span class=line><span class=cl><span class=c1># Create a figure with a specified size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mf>2.5</span><span class=p>,</span> <span class=mf>2.5</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Define the data values and labels for the pie chart</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=p>[</span><span class=mi>170</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>68</span><span class=p>,</span> <span class=mi>24</span><span class=p>,</span> <span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>labels</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;Cropland&#34;</span><span class=p>,</span> <span class=s2>&#34;Forest&#34;</span><span class=p>,</span> <span class=s2>&#34;Grassland&#34;</span><span class=p>,</span> <span class=s2>&#34;Plantation&#34;</span><span class=p>,</span> <span class=s2>&#34;Other&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a pie chart with custom settings</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>pie</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>pctdistance</span><span class=o>=</span><span class=mf>0.75</span><span class=p>,</span> <span class=n>autopct</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%.1f%%</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>colors</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;#ca6924&#34;</span><span class=p>,</span> <span class=s2>&#34;#0c8918&#34;</span><span class=p>,</span> <span class=s2>&#34;#66C3B1&#34;</span><span class=p>,</span> <span class=s2>&#34;#e29c45&#34;</span><span class=p>,</span> <span class=s2>&#34;#EBE8BF&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a white circle at the center to make it look like a donut chart</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>pie</span><span class=p>([</span><span class=mi>1</span><span class=p>],</span> <span class=n>radius</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>colors</span><span class=o>=</span><span class=s1>&#39;w&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the title for the pie chart</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>&#39;Arid&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>17</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save the figure to a file with a specified format, tight layout, and DPI</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Fig/Fig_pie_arid.jpg&#34;</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s2>&#34;tight&#34;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>600</span><span class=p>)</span>
</span></span></code></pre></div><img src=\images\article3\Fig1.jpg alt=None/><h2 id=fig2a>Fig2(a)</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python</span>
</span></span><span class=line><span class=cl><span class=c1># We pre-graded the nitrous oxide emissions and set the appropriate size</span>
</span></span><span class=line><span class=cl><span class=c1># Import necessary libraries</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>geopandas</span> <span class=k>as</span> <span class=nn>gp</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>shapely.geometry</span> <span class=kn>import</span> <span class=n>Point</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>seaborn</span> <span class=k>as</span> <span class=nn>sns</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib</span> <span class=k>as</span> <span class=nn>mpt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>libtiff</span> <span class=kn>import</span> <span class=n>TIFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the font family for matplotlib</span>
</span></span><span class=line><span class=cl><span class=n>mpt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;font.family&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;Times New Roman&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Read data from an Excel file named &#34;N2O.xlsx&#34;</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_excel</span><span class=p>(</span><span class=s2>&#34;N2O.xlsx&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a figure and axis with a specified size</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>12</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Load world map data from geopandas</span>
</span></span><span class=line><span class=cl><span class=n>world</span> <span class=o>=</span> <span class=n>gp</span><span class=o>.</span><span class=n>read_file</span><span class=p>(</span><span class=n>gp</span><span class=o>.</span><span class=n>datasets</span><span class=o>.</span><span class=n>get_path</span><span class=p>(</span><span class=s1>&#39;naturalearth_lowres&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Plot the world map with specific styling</span>
</span></span><span class=line><span class=cl><span class=n>world</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>ax</span><span class=o>=</span><span class=n>ax</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;white&#39;</span><span class=p>,</span> <span class=n>edgecolor</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the aspect ratio to equal for a more accurate representation</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_aspect</span><span class=p>(</span><span class=s1>&#39;equal&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create scatter plots for different data points (P1, P2, P3, P4) with specific colors, labels, and markers</span>
</span></span><span class=line><span class=cl><span class=n>P1</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;Longitude_A&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;Latitude_A&#39;</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=s2>&#34;#FB7D07&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Arid&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=n>data</span><span class=p>[</span><span class=s2>&#34;SIZE_A&#34;</span><span class=p>],</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>P2</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;Longitude_B&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;Latitude_B&#39;</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=s2>&#34;#7CFC00&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Semi arid and humid&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=n>data</span><span class=p>[</span><span class=s2>&#34;SIZE_B&#34;</span><span class=p>],</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>P3</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;Longitude_C&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;Latitude_C&#39;</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=s2>&#34;#0FF1F9&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Humid&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=n>data</span><span class=p>[</span><span class=s2>&#34;SIZE_C&#34;</span><span class=p>],</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>P4</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;Longitude_D&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;Latitude_D&#39;</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=s2>&#34;#1E90FF&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Extreme humid&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=n>data</span><span class=p>[</span><span class=s2>&#34;SIZE_D&#34;</span><span class=p>],</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set y-axis and x-axis limits and ticks</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>(</span><span class=o>-</span><span class=mi>60</span><span class=p>,</span> <span class=mi>85</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>yticks</span><span class=p>([</span><span class=o>-</span><span class=mi>50</span><span class=p>,</span> <span class=o>-</span><span class=mi>25</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>75</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlim</span><span class=p>(</span><span class=o>-</span><span class=mi>165</span><span class=p>,</span> <span class=mi>185</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xticks</span><span class=p>([</span><span class=o>-</span><span class=mi>150</span><span class=p>,</span> <span class=o>-</span><span class=mi>100</span><span class=p>,</span> <span class=o>-</span><span class=mi>50</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>150</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set tick label font size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>labelsize</span><span class=o>=</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add text to indicate the subplot as &#34;(a)&#34;</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=o>-</span><span class=mi>160</span><span class=p>,</span> <span class=mi>75</span><span class=p>,</span> <span class=s2>&#34;(a)&#34;</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add a legend with specified location, frame, and font size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>loc</span><span class=o>=</span><span class=s1>&#39;best&#39;</span><span class=p>,</span> <span class=n>frameon</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save the figure to a file with a specified format, tight layout, and DPI</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Fig/AI distribution map legend.jpg&#34;</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s2>&#34;tight&#34;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>600</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=fig2b>Fig2(b)</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python</span>
</span></span><span class=line><span class=cl><span class=c1># Import necessary libraries</span>
</span></span><span class=line><span class=cl><span class=c1># Import necessary libraries</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>geopandas</span> <span class=k>as</span> <span class=nn>gp</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>shapely.geometry</span> <span class=kn>import</span> <span class=n>Point</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>seaborn</span> <span class=k>as</span> <span class=nn>sns</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib</span> <span class=k>as</span> <span class=nn>mpt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>libtiff</span> <span class=kn>import</span> <span class=n>TIFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Read data from an Excel file named &#34;Data_N2O_LJY_20221021.xlsx&#34;</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_excel</span><span class=p>(</span><span class=s2>&#34;Data_N2O_LJY_20221021.xlsx&#34;</span><span class=p>,</span> <span class=n>sheet_name</span><span class=o>=</span><span class=s1>&#39;line&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a figure with a specified size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mf>5.5</span><span class=p>,</span> <span class=mf>3.5</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a regression plot (regplot) with specific settings</span>
</span></span><span class=line><span class=cl><span class=n>sns</span><span class=o>.</span><span class=n>regplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;latitude&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;N2O&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>ci</span><span class=o>=</span><span class=mi>30</span><span class=p>,</span> <span class=n>order</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>line_kws</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>lw</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>zorder</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>scatter_kws</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>s</span><span class=o>=</span><span class=mf>0.00000001</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.04</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>zorder</span><span class=o>=-</span><span class=mi>50</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a scatter plot with color mapping for &#39;P/PET&#39; using a rainbow colormap</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s2>&#34;latitude&#34;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s2>&#34;N2O&#34;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=s2>&#34;P/PET&#34;</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;rainbow_r&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>,</span> <span class=n>vmin</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>vmax</span><span class=o>=</span><span class=mf>1.8</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>30</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add a colorbar with specific settings</span>
</span></span><span class=line><span class=cl><span class=n>cbar</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>colorbar</span><span class=p>(</span><span class=n>orientation</span><span class=o>=</span><span class=s1>&#39;vertical&#39;</span><span class=p>,</span> <span class=n>drawedges</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>shrink</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>pad</span><span class=o>=</span><span class=mf>0.03</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cbar</span><span class=o>.</span><span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;AI&#39;</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set x and y axis labels</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Latitudes(°)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;$\mathregular</span><span class=si>{N_2}</span><span class=s1>$O fluxes(μgN·m$^{-2}$·h$^{-1}$)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set y-axis limits</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>(</span><span class=o>-</span><span class=mi>500</span><span class=p>,</span> <span class=mi>1500</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set tick label font size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>labelsize</span><span class=o>=</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cbar</span><span class=o>.</span><span class=n>ax</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>labelsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add text to indicate the subplot as &#34;(b)&#34;</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=o>-</span><span class=mi>5</span><span class=p>,</span> <span class=mi>1300</span><span class=p>,</span> <span class=s2>&#34;(b)&#34;</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save the figure to a file with a specified format, tight layout, and DPI</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Fig/FigN2O_flux_SW_PPET.jpg&#34;</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s2>&#34;tight&#34;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>600</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=fig2c>Fig2(c)</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python</span>
</span></span><span class=line><span class=cl><span class=c1># Import necessary libraries</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>seaborn</span> <span class=k>as</span> <span class=nn>sns</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a figure with a specified size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mf>5.5</span><span class=p>,</span> <span class=mf>3.5</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Read data from an Excel file named &#34;Data_N2O_LJY_20221021.xlsx&#34; from the &#39;line&#39; sheet</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_excel</span><span class=p>(</span><span class=s2>&#34;Data_N2O_LJY_20221021.xlsx&#34;</span><span class=p>,</span> <span class=n>sheet_name</span><span class=o>=</span><span class=s1>&#39;line&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Define a dictionary for mapping climate zones to colors</span>
</span></span><span class=line><span class=cl><span class=n>dict_color</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span><span class=n>Arid</span><span class=o>=</span><span class=s2>&#34;#FB7D07&#34;</span><span class=p>,</span> <span class=n>Semi</span><span class=o>=</span><span class=s2>&#34;#7CFC00&#34;</span><span class=p>,</span> <span class=n>Humid</span><span class=o>=</span><span class=s2>&#34;#0FF1F9&#34;</span><span class=p>,</span> <span class=n>Extreme</span><span class=o>=</span><span class=s2>&#34;#1E90FF&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a bar plot (barplot) with specific settings</span>
</span></span><span class=line><span class=cl><span class=n>ax</span> <span class=o>=</span> <span class=n>sns</span><span class=o>.</span><span class=n>barplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;climate&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;N2O&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;dict_color&#39;</span><span class=p>,</span> <span class=n>capsize</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>saturation</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>errcolor</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=n>errwidth</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>ci</span><span class=o>=</span><span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the y-axis limits and ticks</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>400</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>yticks</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>300</span><span class=p>,</span> <span class=mi>400</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set y-axis and x-axis labels</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>&#34;$\mathregular</span><span class=si>{N_2}</span><span class=s2>$O fluxes(μgN·m$^{-2}$·h$^{-1}$)&#34;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Climate zones&#39;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set tick label font size and rotate x-axis labels to 0 degrees</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>labelsize</span><span class=o>=</span><span class=mi>13</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xticks</span><span class=p>(</span><span class=n>rotation</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add text to indicate the subplot as &#34;(c)&#34;</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=o>-</span><span class=mf>0.4</span><span class=p>,</span> <span class=mi>360</span><span class=p>,</span> <span class=s2>&#34;(c)&#34;</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the counts for each column</span>
</span></span><span class=line><span class=cl><span class=n>columncounts</span> <span class=o>=</span> <span class=p>[</span><span class=mi>40</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>40</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Define a function to normalize counts to the interval 0-1</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>normaliseCounts</span><span class=p>(</span><span class=n>widths</span><span class=p>,</span> <span class=n>maxwidth</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>widths</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>widths</span><span class=p>)</span> <span class=o>/</span> <span class=nb>float</span><span class=p>(</span><span class=n>maxwidth</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>widths</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Normalize the counts and adjust the bar widths and positions</span>
</span></span><span class=line><span class=cl><span class=n>widthbars</span> <span class=o>=</span> <span class=n>normaliseCounts</span><span class=p>(</span><span class=n>columncounts</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>bar</span><span class=p>,</span> <span class=n>newwidth</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>ax</span><span class=o>.</span><span class=n>patches</span><span class=p>,</span> <span class=n>widthbars</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>bar</span><span class=o>.</span><span class=n>get_x</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>width</span> <span class=o>=</span> <span class=n>bar</span><span class=o>.</span><span class=n>get_width</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>centre</span> <span class=o>=</span> <span class=n>x</span> <span class=o>+</span> <span class=n>width</span> <span class=o>/</span> <span class=mf>2.</span>
</span></span><span class=line><span class=cl>    <span class=n>bar</span><span class=o>.</span><span class=n>set_x</span><span class=p>(</span><span class=n>centre</span> <span class=o>-</span> <span class=n>newwidth</span> <span class=o>/</span> <span class=mf>2.</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>bar</span><span class=o>.</span><span class=n>set_width</span><span class=p>(</span><span class=n>newwidth</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save the figure to a file with a specified format, tight layout, and DPI</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Fig/Figbar.jpg&#34;</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s2>&#34;tight&#34;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>600</span><span class=p>)</span>
</span></span></code></pre></div><img src=\images\article3\Fig2.jpg alt=None/><h2 id=fig3>Fig3</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python</span>
</span></span><span class=line><span class=cl><span class=c1># Arrange the scatter plot in advance</span>
</span></span><span class=line><span class=cl><span class=c1># Import necessary libraries</span>
</span></span><span class=line><span class=cl><span class=o>%</span><span class=n>matplotlib</span> <span class=n>inline</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>mpl_toolkits.axisartist.parasite_axes</span> <span class=kn>import</span> <span class=n>HostAxes</span><span class=p>,</span> <span class=n>ParasiteAxes</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib</span> <span class=k>as</span> <span class=nn>mpt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>seaborn</span> <span class=k>as</span> <span class=nn>sns</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.ticker</span> <span class=k>as</span> <span class=nn>ticker</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set font family to &#34;Times New Roman&#34;</span>
</span></span><span class=line><span class=cl><span class=n>mpt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;font.family&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;Times New Roman&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Read data from an Excel file named &#34;tree.xlsx&#34;</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_excel</span><span class=p>(</span><span class=s2>&#34;tree.xlsx&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a figure with a specified size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mf>3.5</span><span class=p>,</span> <span class=mf>3.5</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a scatter plot with specific settings, including color mapping for &#39;fluxes&#39; using a Blues colormap</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=s2>&#34;fluxes&#34;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;Blues&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>vmin</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>vmax</span><span class=o>=</span><span class=mi>200</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>40</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add a colorbar with specific settings</span>
</span></span><span class=line><span class=cl><span class=n>cbar</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>colorbar</span><span class=p>(</span><span class=n>orientation</span><span class=o>=</span><span class=s1>&#39;vertical&#39;</span><span class=p>,</span> <span class=n>drawedges</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>shrink</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>pad</span><span class=o>=</span><span class=mf>0.03</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cbar</span><span class=o>.</span><span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;$\mathregular</span><span class=si>{N_2}</span><span class=s1>$O fluxes(μgN·m$^{-2}$·h$^{-1}$)&#39;</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Remove y and x-axis labels</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>13</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>13</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set y-axis and x-axis limits</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>40</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set tick label font size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>labelsize</span><span class=o>=</span><span class=mi>13</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save the figure to a file with a specified format, tight layout, and DPI</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Fig/Tree.jpg&#34;</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s2>&#34;tight&#34;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>600</span><span class=p>)</span>
</span></span></code></pre></div><img src=\images\article3\Fig3.jpg alt=None/><h2 id=fig4a>Fig4(a)</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#python</span>
</span></span><span class=line><span class=cl><span class=c1># Import necessary libraries</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=o>%</span><span class=n>matplotlib</span> <span class=n>inline</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>geopandas</span> <span class=k>as</span> <span class=nn>gp</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>shapely.geometry</span> <span class=kn>import</span> <span class=n>Point</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>seaborn</span> <span class=k>as</span> <span class=nn>sns</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib</span> <span class=k>as</span> <span class=nn>mpt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>libtiff</span> <span class=kn>import</span> <span class=n>TIFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the font family to &#34;Times New Roman&#34;</span>
</span></span><span class=line><span class=cl><span class=n>mpt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;font.family&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;Times New Roman&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Read data from an Excel file named &#34;SIZE2.xlsx&#34;</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_excel</span><span class=p>(</span><span class=s2>&#34;SIZE2.xlsx&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a figure with a specified size</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>12</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Load world map data</span>
</span></span><span class=line><span class=cl><span class=n>world</span> <span class=o>=</span> <span class=n>gp</span><span class=o>.</span><span class=n>read_file</span><span class=p>(</span><span class=n>gp</span><span class=o>.</span><span class=n>datasets</span><span class=o>.</span><span class=n>get_path</span><span class=p>(</span><span class=s1>&#39;naturalearth_lowres&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Plot the world map as the background</span>
</span></span><span class=line><span class=cl><span class=n>world</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>ax</span><span class=o>=</span><span class=n>ax</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;white&#39;</span><span class=p>,</span> <span class=n>edgecolor</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the aspect ratio to be equal</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_aspect</span><span class=p>(</span><span class=s1>&#39;equal&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create scatter plots for different land cover types with specified colors, sizes, and labels</span>
</span></span><span class=line><span class=cl><span class=n>P1</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;Longitude_A&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;Latitude_A&#39;</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=s2>&#34;#f2a20d&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Cropland&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=s2>&#34;SIZE_A&#34;</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>P2</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;Longitude_B&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;Latitude_B&#39;</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=s2>&#34;#5ca781&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Forest&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=s2>&#34;SIZE_B&#34;</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>P3</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;Longitude_C&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;Latitude_C&#39;</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=s2>&#34;#358b9c&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Grassland&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=s2>&#34;SIZE_C&#34;</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>P4</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;Longitude_D&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;Latitude_D&#39;</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=s2>&#34;#d26763&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Plantation&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=s2>&#34;SIZE_D&#34;</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set y-axis and x-axis limits and tick positions</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>(</span><span class=o>-</span><span class=mi>60</span><span class=p>,</span> <span class=mi>85</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>yticks</span><span class=p>([</span><span class=o>-</span><span class=mi>50</span><span class=p>,</span> <span class=o>-</span><span class=mi>25</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>75</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlim</span><span class=p>(</span><span class=o>-</span><span class=mi>165</span><span class=p>,</span> <span class=mi>185</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xticks</span><span class=p>([</span><span class=o>-</span><span class=mi>150</span><span class=p>,</span> <span class=o>-</span><span class=mi>100</span><span class=p>,</span> <span class=o>-</span><span class=mi>50</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>150</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set tick label font size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>labelsize</span><span class=o>=</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add a text label &#34;(a)&#34;</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=o>-</span><span class=mi>164</span><span class=p>,</span> <span class=mi>75</span><span class=p>,</span> <span class=s2>&#34;(a)&#34;</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add a legend with specified settings</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>loc</span><span class=o>=</span><span class=s1>&#39;best&#39;</span><span class=p>,</span> <span class=n>frameon</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save the figure to a file with a specified format and DPI</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Fig/AI distribution map legend.jpg&#34;</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s2>&#34;tight&#34;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>600</span><span class=p>)</span>
</span></span></code></pre></div><h1 id=fig4b>Fig4(b)</h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python</span>
</span></span><span class=line><span class=cl><span class=c1># Create a new figure with a specified size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Read data from a CSV file, setting &#39;zone&#39; column as the index</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;data.csv&#39;</span><span class=p>,</span> <span class=n>index_col</span><span class=o>=</span><span class=s1>&#39;zone&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Select specific columns from the data and create a horizontal stacked bar plot</span>
</span></span><span class=line><span class=cl><span class=n>data1</span> <span class=o>=</span> <span class=n>data</span><span class=p>[[</span><span class=s1>&#39;Cropland&#39;</span><span class=p>,</span> <span class=s1>&#39;Forest&#39;</span><span class=p>,</span> <span class=s1>&#39;Grassland&#39;</span><span class=p>,</span> <span class=s1>&#39;Plantation&#39;</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=n>data1</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>kind</span><span class=o>=</span><span class=s1>&#39;barh&#39;</span><span class=p>,</span> <span class=n>use_index</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>stacked</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;#f2a20d&#39;</span><span class=p>,</span> <span class=s1>&#39;#5ca781&#39;</span><span class=p>,</span> <span class=s1>&#39;#358b9c&#39;</span><span class=p>,</span> <span class=s1>&#39;#d26763&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the font size for tick labels</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>labelsize</span><span class=o>=</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the label for the x-axis and specify its font size</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Nitrogen application (KgN·ha$^{-1}$)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the x-axis and y-axis limits</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1200</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>(</span><span class=o>-</span><span class=mf>0.8</span><span class=p>,</span> <span class=mf>3.8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add a legend with specified settings</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>ncol</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add text label &#34;(b)&#34;</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mf>3.45</span><span class=p>,</span> <span class=s2>&#34;(b)&#34;</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save the figure to a file with a specified format and DPI</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Fig/fig4(b).jpg&#34;</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s2>&#34;tight&#34;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>600</span><span class=p>)</span>
</span></span></code></pre></div><h1 id=fig4c>Fig4(c)</h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>seaborn</span> <span class=k>as</span> <span class=nn>sns</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>mscatter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>m</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=kn>import</span> <span class=nn>matplotlib.markers</span> <span class=k>as</span> <span class=nn>mmarkers</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>ax</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>sc</span> <span class=o>=</span> <span class=n>ax</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>m</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>)</span> <span class=ow>and</span> <span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>m</span><span class=p>)</span> <span class=o>==</span> <span class=nb>len</span><span class=p>(</span><span class=n>x</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=n>paths</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>marker</span> <span class=ow>in</span> <span class=n>m</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>marker</span><span class=p>,</span> <span class=n>mmarkers</span><span class=o>.</span><span class=n>MarkerStyle</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>marker_obj</span> <span class=o>=</span> <span class=n>marker</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>marker_obj</span> <span class=o>=</span> <span class=n>mmarkers</span><span class=o>.</span><span class=n>MarkerStyle</span><span class=p>(</span><span class=n>marker</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>path</span> <span class=o>=</span> <span class=n>marker_obj</span><span class=o>.</span><span class=n>get_path</span><span class=p>()</span><span class=o>.</span><span class=n>transformed</span><span class=p>(</span><span class=n>marker_obj</span><span class=o>.</span><span class=n>get_transform</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=n>paths</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sc</span><span class=o>.</span><span class=n>set_paths</span><span class=p>(</span><span class=n>paths</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>sc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>N</span> <span class=o>=</span> <span class=mi>15</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=p>[</span><span class=mf>188.639</span><span class=p>,</span> <span class=mf>83.606</span><span class=p>,</span> <span class=mf>252.779</span><span class=p>,</span> <span class=mf>238.157</span><span class=p>,</span> <span class=mf>90.2</span><span class=p>,</span> <span class=mf>324.484</span><span class=p>,</span> <span class=mf>112.5</span><span class=p>,</span> <span class=mf>226.117</span><span class=p>,</span> <span class=mf>56.935</span><span class=p>,</span> <span class=mf>207.386</span><span class=p>,</span> <span class=mi>120</span><span class=p>,</span> <span class=mf>230.513</span><span class=p>,</span> <span class=mf>89.949</span><span class=p>,</span> <span class=mf>301.417</span><span class=p>,</span> <span class=mf>217.477</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=p>[</span><span class=mf>112.75</span><span class=p>,</span> <span class=mf>64.96</span><span class=p>,</span> <span class=mf>16.94</span><span class=p>,</span> <span class=mf>110.68</span><span class=p>,</span> <span class=mf>16.49</span><span class=p>,</span> <span class=mf>126.5</span><span class=p>,</span> <span class=mf>18.85</span><span class=p>,</span> <span class=mf>97.23</span><span class=p>,</span> <span class=mf>38.59</span><span class=p>,</span> <span class=mf>69.71</span><span class=p>,</span> <span class=mf>131.13</span><span class=p>,</span> <span class=mf>268.38</span><span class=p>,</span> <span class=mi>43</span><span class=p>,</span> <span class=mf>137.64</span><span class=p>,</span> <span class=mf>150.56</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>g</span> <span class=o>=</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>h</span> <span class=o>=</span> <span class=p>{</span><span class=mi>5</span><span class=p>:</span> <span class=s1>&#39;#f2a20d&#39;</span><span class=p>,</span> <span class=mi>6</span><span class=p>:</span> <span class=s1>&#39;#5ca781&#39;</span><span class=p>,</span> <span class=mi>7</span><span class=p>:</span> <span class=s1>&#39;#358b9c&#39;</span><span class=p>,</span> <span class=mi>8</span><span class=p>:</span> <span class=s1>&#39;#d26763&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=p>{</span><span class=mi>1</span><span class=p>:</span> <span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=mi>2</span><span class=p>:</span> <span class=s1>&#39;s&#39;</span><span class=p>,</span> <span class=mi>3</span><span class=p>:</span> <span class=s1>&#39;D&#39;</span><span class=p>,</span> <span class=mi>4</span><span class=p>:</span> <span class=s1>&#39;^&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>cm</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>m</span><span class=p>[</span><span class=n>x</span><span class=p>],</span> <span class=n>c</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>ch</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>h</span><span class=p>[</span><span class=n>x</span><span class=p>],</span> <span class=n>g</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>scatter</span> <span class=o>=</span> <span class=n>mscatter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=n>ch</span><span class=p>,</span> <span class=n>m</span><span class=o>=</span><span class=n>cm</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=n>plt</span><span class=o>.</span><span class=n>cm</span><span class=o>.</span><span class=n>RdYlBu</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>125</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Generate a regression plot using seaborn</span>
</span></span><span class=line><span class=cl><span class=n>data2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;fertilizer&#39;</span><span class=p>:</span> <span class=n>x</span><span class=p>,</span> <span class=s1>&#39;fluxes&#39;</span><span class=p>:</span> <span class=n>y</span><span class=p>})</span>  <span class=c1># Convert x and y to a DataFrame</span>
</span></span><span class=line><span class=cl><span class=n>sns</span><span class=o>.</span><span class=n>regplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;fertilizer&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;fluxes&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data2</span><span class=p>,</span> <span class=n>ci</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>order</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>line_kws</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>lw</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>zorder</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>scatter_kws</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>s</span><span class=o>=</span><span class=mf>0.00000001</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mf>0.04</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>zorder</span><span class=o>=-</span><span class=mi>50</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the axis labels</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Nitrogen application (KgN·ha$^{-1}$)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;$\mathregular</span><span class=si>{N_2}</span><span class=s1>$O fluxes (μgN·m$^{-2}$·h$^{-1}$)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Adjust the font size of ticks</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>labelsize</span><span class=o>=</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save the figure</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s2>&#34;Fig/point.jpg&#34;</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s2>&#34;tight&#34;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>600</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Display the plot (optional)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><img src=\images\article3\Fig4.jpg alt=None/></div><div class=post__footer><span><a class=tag href=/tags/writing/>Writing</a></span></div></div></main></div><footer class="footer footer__base"><ul class=footer__list><li class=footer__item>&copy;
Yukun Lu
2023</li></ul></footer><script type=text/javascript src=/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ=" crossorigin=anonymous></script></body></html>